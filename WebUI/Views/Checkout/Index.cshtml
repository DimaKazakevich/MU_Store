@model WebUI.Models.CheckoutViewModel
@using Microsoft.AspNet.Identity

<style>
    .combobox {
        display: inline-block;
        position: relative;
    }

        .combobox select {
            display: none;
            position: absolute;
            overflow-y: auto;
        }
</style>

<style>
    .col-xs-8 {
        width: max-content;
    }

    .row.panel {
        justify-content: center;
    }

    #deliverable-countries {
        font-size: 14px;
        color: #000;
        height: 42px;
        border: 1px solid #000;
        border-radius: 0;
        width: 100%;
        padding: 5px 10px;
        box-shadow: none;
    }

    #orderSummaryContainer {
        width: 392px;
        padding: 0 14px 25px 14px;
        background: #fff;
        position: relative;
        margin-bottom: 14px;
    }

    #orderSummaryHeader {
        display: flex;
        margin: 0;
        align-items: center;
        height: 53px;
    }

    .scrollableContentContainer {
        overflow: hidden;
        border-top: 1px solid silver;
        border-bottom: 1px solid silver;
        margin-bottom: 30px;
    }

    .scrollableContent {
        height: 300px;
        overflow-y: auto;
    }

    .summaryTotals {
        display: flex;
        font-family: montserratsemibold;
        font-size: 18px;
        margin-bottom: 7px;
    }

    .container-fluid {
        margin-right: auto;
        margin-left: auto;
        padding-left: 15px;
        padding-right: 15px;
        display: flex;
    }

    .itemDescription {
        font-size: 14px;
        font-weight: 600;
    }

    .itemVariationLabel {
        display: inline-block;
        max-width: 100%;
        margin-bottom: 5px;
        font-weight: bold;
        font-size: 12px;
    }

    .itemQuantityLabel {
        display: inline-block;
        max-width: 100%;
        margin-bottom: 5px;
        font-weight: bold;
        font-size: 12px;
    }

    .showPriceLabel {
        display: inline-block;
        max-width: 100%;
        margin-bottom: 5px;
        font-weight: bold;
        font-size: 12px;
    }

    .content {
        background-color: #f1f1f1;
    }

    .row.panel {
        background-color: #f1f1f1;
    }

    .summaryLineLeft {
        font-size: 24px;
        text-transform: uppercase;
        font-weight: 600;
    }

    #CheckoutProgressSection {
        padding-top: 14px;
        padding-bottom: 25px;
        background: #f1f1f1;
        position: relative;
        display: flex;
    }

    .progress-circle {
        border: none;
        background-color: #00a92c;
        margin: auto;
        border-top-left-radius: 50% 50%;
        border-top-right-radius: 50% 50%;
        border-bottom-left-radius: 50% 50%;
        border-bottom-right-radius: 50% 50%;
        width: 51px;
        height: 51px;
        border: 1px solid #000;
        text-align: center;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .steps-timeline {
        display: flex;
        justify-content: space-between;
    }

    .line {
        border-top: 1px solid #55ba4d;
    }

    #CheckoutProgressSection .line.part1 {
        right: 50%;
    }

    #CheckoutProgressSection .line {
        border-top: 1px solid #000;
        left: 17%;
        right: 17%;
        top: 39px;
        z-index: 1;
    }

    #CheckoutProgressSection .line {
        border-top: 1px solid #d7d7d7;
        left: 18%;
        right: 18%;
        top: 22px;
        position: absolute;
    }

        #CheckoutProgressSection .line.part2 {
            left: 50%;
        }

    #CheckoutProgressSection .line {
        border-top: 1px solid #000;
        left: 17%;
        right: 17%;
        top: 39px;
        z-index: 1;
    }

    #CheckoutProgressSection .line {
        border-top: 1px solid #d7d7d7;
        left: 18%;
        right: 18%;
        top: 22px;
        position: absolute;
    }

    .steps.progress-completed {
        flex: 1 1 0%;
        z-index: 2;
    }

    #CheckoutProgressSection {
        background: white;
        margin-bottom: 30px;
        justify-content: space-between;
    }

    #orderDetails {
        margin-right: 10px;
    }
</style>
@using (Html.BeginForm("AddNewOrder", "Checkout", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
{
    @Html.AntiForgeryToken()

    <div style="display:flex">
        <section id="orderDetails" style="display:flex; flex-direction:column">
            @*<div class="delivery-country">
                <span class="helpText ng-binding">Please Deliver My Parcel to</span>
                <select id="deliverable-countries" name="deliverableCountries" class="form-control input-sm drop-down ng-pristine ng-untouched ng-valid ng-valid-required">
                    <optgroup label="Common">
                        <option value="204" label="United Kingdom">United Kingdom</option>
                        <option value="206" label="United States of America">United States of America</option>
                        <option value="73" label="Germany">Germany</option>
                        <option value="175" label="Spain (Mainland)">Spain (Mainland)</option>
                        <option value="11" label="Australia">Australia</option>
                        <option value="35" label="Canada">Canada</option>
                        <option value="54" label="Denmark">Denmark</option>
                        <option value="68" label="France">France</option>
                        <option value="147" label="Norway">Norway</option>
                    </optgroup>
                    <optgroup label="Other">
                        <option value="230" label="Abu Dhabi">Abu Dhabi</option>
                        <option value="3" selected="selected" label="American Samoa">American Samoa</option>
                        <option value="4" label="Andorra">Andorra</option>
                        <option value="6" label="Anguilla">Anguilla</option>
                        <option value="7" label="Antigua">Antigua</option>
                        <option value="9" label="Armenia">Armenia</option>
                        <option value="12" label="Austria">Austria</option>
                        <option value="224" label="Azores">Azores</option>
                        <option value="14" label="Bahamas">Bahamas</option>
                        <option value="15" label="Bahrain">Bahrain</option>
                        <option value="17" label="Barbados">Barbados</option>
                        <option value="227" label="Barbuda">Barbuda</option>
                        <option value="300" label="Belarus">Belarus</option>
                        <option value="19" label="Belgium">Belgium</option>
                        <option value="21" label="Benin">Benin</option>
                        <option value="28" label="Brazil">Brazil</option>
                        <option value="30" label="Bulgaria">Bulgaria</option>
                        <option value="32" label="Burundi">Burundi</option>
                        <option value="34" label="Cameroon">Cameroon</option>
                        <option value="37" label="Cape Verde">Cape Verde</option>
                        <option value="38" label="Cayman Islands">Cayman Islands</option>
                        <option value="39" label="Central African Rep.">Central African Rep.</option>
                        <option value="40" label="Chad">Chad</option>
                        <option value="41" label="Channel Islands">Channel Islands</option>
                        <option value="42" label="Chile">Chile</option>
                        <option value="43" label="China">China</option>
                        <option value="44" label="Colombia">Colombia</option>
                        <option value="45" label="Comoros">Comoros</option>
                        <option value="46" label="Congo">Congo</option>
                        <option value="47" label="Cook Islands">Cook Islands</option>
                        <option value="231" label="Corsica">Corsica</option>
                        <option value="49" label="Croatia">Croatia</option>
                        <option value="52" label="Cyprus">Cyprus</option>
                        <option value="53" label="Czech Republic">Czech Republic</option>
                        <option value="236" label="Côte D'Ivoire">Côte D'Ivoire</option>
                        <option value="55" label="Djibouti">Djibouti</option>
                        <option value="56" label="Dominica">Dominica</option>
                        <option value="57" label="Dominican Republic">Dominican Republic</option>
                        <option value="229" label="Dubai">Dubai</option>
                        <option value="59" label="Egypt">Egypt</option>
                        <option value="61" label="Equatorial Guinea">Equatorial Guinea</option>
                        <option value="62" label="Eritrea">Eritrea</option>
                        <option value="63" label="Estonia">Estonia</option>
                        <option value="64" label="Ethiopia">Ethiopia</option>
                        <option value="65" label="Faroe Islands">Faroe Islands</option>
                        <option value="66" label="Fiji">Fiji</option>
                        <option value="67" label="Finland">Finland</option>
                        <option value="69" label="French Guyana">French Guyana</option>
                        <option value="70" label="Gabon">Gabon</option>
                        <option value="71" label="Gambia">Gambia</option>
                        <option value="72" label="Georgia">Georgia</option>
                        <option value="74" label="Ghana">Ghana</option>
                        <option value="75" label="Gibraltar">Gibraltar</option>
                        <option value="76" label="Greece">Greece</option>
                        <option value="77" label="Greenland">Greenland</option>
                        <option value="78" label="Grenada">Grenada</option>
                        <option value="79" label="Guadeloupe">Guadeloupe</option>
                        <option value="81" label="Guatemala">Guatemala</option>
                        <option value="83" label="Guinea Rep.">Guinea Rep.</option>
                        <option value="82" label="Guinea-Bissau">Guinea-Bissau</option>
                        <option value="84" label="Guyana(British)">Guyana(British)</option>
                        <option value="87" label="Hong Kong, China">Hong Kong, China</option>
                        <option value="88" label="Hungary">Hungary</option>
                        <option value="89" label="Iceland">Iceland</option>
                        <option value="93" label="Ireland (Eire)">Ireland (Eire)</option>
                        <option value="242" label="Isle of Man">Isle of Man</option>
                        <option value="94" label="Israel">Israel</option>
                        <option value="95" label="Italy">Italy</option>
                        <option value="98" label="Japan">Japan</option>
                        <option value="99" label="Jordan">Jordan</option>
                        <option value="101" label="Kenya">Kenya</option>
                        <option value="104" label="Korea (Republic)">Korea (Republic)</option>
                        <option value="105" label="Kuwait">Kuwait</option>
                        <option value="108" label="Latvia">Latvia</option>
                        <option value="109" label="Lebanon">Lebanon</option>
                        <option value="110" label="Lesotho">Lesotho</option>
                        <option value="113" label="Liechtenstein">Liechtenstein</option>
                        <option value="114" label="Lithuania">Lithuania</option>
                        <option value="115" label="Luxembourg">Luxembourg</option>
                        <option value="116" label="Macau, China">Macau, China</option>
                        <option value="118" label="Madagascar">Madagascar</option>
                        <option value="233" label="Madeira">Madeira</option>
                        <option value="119" label="Malawi">Malawi</option>
                        <option value="120" label="Malaysia">Malaysia</option>
                        <option value="123" label="Malta">Malta</option>
                        <option value="124" label="Marshall Islands">Marshall Islands</option>
                        <option value="125" label="Martinique">Martinique</option>
                        <option value="126" label="Mauritania">Mauritania</option>
                        <option value="128" label="Mexico">Mexico</option>
                        <option value="130" label="Monaco">Monaco</option>
                        <option value="132" label="Montserrat">Montserrat</option>
                        <option value="136" label="Namibia">Namibia</option>
                        <option value="139" label="Nederland">Nederland</option>
                        <option value="142" label="New Zealand">New Zealand</option>
                        <option value="144" label="Niger">Niger</option>
                        <option value="220" label="Northern Ireland">Northern Ireland</option>
                        <option value="148" label="Oman">Oman</option>
                        <option value="151" label="Papua New Guinea">Papua New Guinea</option><
                        <option value="152" label="Paraguay">Paraguay</option>
                        <option value="153" label="Peru">Peru</option>
                        <option value="155" label="Poland">Poland</option>
                        <option value="156" label="Portugal">Portugal</option>
                        <option value="157" label="Puerto Rico">Puerto Rico</option>
                        <option value="158" label="Qatar">Qatar</option>
                        <option value="159" label="Reunion Island">Reunion Island</option>
                        <option value="160" label="Romania">Romania</option>
                        <option value="161" label="Russian Federation">Russian Federation</option>
                        <option value="163" label="Saipan (USA Island)">Saipan (USA Island)</option>
                        <option value="238" label="San Marino">San Marino</option>
                        <option value="165" label="Saudi Arabia">Saudi Arabia</option>
                        <option value="167" label="Seychelles">Seychelles</option>
                        <option value="168" label="Sierra Leone">Sierra Leone</option>
                        <option value="169" label="Singapore">Singapore</option>
                        <option value="170" label="Slovakia">Slovakia</option>
                        <option value="171" label="Slovenia">Slovenia</option>
                        <option value="36" label="Spain (Canary Islands)">Spain (Canary Islands)</option>
                        <option value="177" label="St Barthelemy">St Barthelemy</option>
                        <option value="225" label="St Christopher">St Christopher</option>
                        <option value="178" label="St Eustatius">St Eustatius</option>
                        <option value="179" label="St Kitts">St Kitts</option>
                        <option value="180" label="St Lucia">St Lucia</option>
                        <option value="181" label="St Maarten">St Maarten</option>
                        <option value="182" label="St Vincent">St Vincent</option>
                        <option value="184" label="Suriname">Suriname</option>
                        <option value="185" label="Swaziland">Swaziland</option>
                        <option value="186" label="Sweden">Sweden</option>
                        <option value="187" label="Switzerland">Switzerland</option>
                        <option value="190" label="Taiwan, China">Taiwan, China</option>
                        <option value="192" label="Tanzania">Tanzania</option>
                        <option value="193" label="Thailand">Thailand</option>
                        <option value="194" label="Togo">Togo</option>
                        <option value="197" label="Turkey">Turkey</option>
                        <option value="350" label="Ukraine">Ukraine</option>
                        <option value="203" label="United Arab Emirates">United Arab Emirates</option>
                        <option value="232" label="Vatican City">Vatican City</option>
                        <option value="211" label="Virgin Islands">Virgin Islands</option>
                        <option value="212" label="Virgin Islands US">Virgin Islands US</option>
                        <option value="217" label="Zambia">Zambia</option>
                    </optgroup>
                </select>
            </div>*@

            @*<div style="display:flex; flex-direction:column;">
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })
                <div class="form-group">
                    @Html.LabelFor(m => m.ShippingDetails.FirstName, new { @class = "col-md-2 control-label" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.ShippingDetails.FirstName, new { @class = "form-control" })
                        @Html.ValidationMessageFor(m => m.ShippingDetails.FirstName, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.ShippingDetails.LastName, new { @class = "col-md-2 control-label" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.ShippingDetails.LastName, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.ShippingDetails.Town, new { @class = "col-md-2 control-label" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.ShippingDetails.Town, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.ShippingDetails.AddresLine, new { @class = "col-md-2 control-label" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.ShippingDetails.AddresLine, new { @class = "form-control" })
                    </div>
                </div>
                <div class="form-group">
                    @Html.LabelFor(m => m.ShippingDetails.Postcode, new { @class = "col-md-2 control-label" })
                    <div class="col-md-10">
                        @Html.TextBoxFor(m => m.ShippingDetails.Postcode, new { @class = "form-control" })
                    </div>
                </div>
            </div>*@
                <button type="submit" id="confirmOrder" class="btn-success" style="height:40px">Confirm Order</button>
            
        </section>

        <aside id="checkoutSidePanel" style="position: relative; margin-left:10px">
            <section id="orderSummaryContainer">
                <div id="orderSummaryHeader">
                    <h3 class="summaryLineLeft">Order Summary</h3>
                </div>
                <section class="scrollableContentContainer">
                    <div class="scrollableContent">
                        <div class="orderPart">
                            <div class="copy" style="font-size:12px">Delivery Estimate: 6 - 7 Business Days</div>
                            <br>
                            @foreach (var line in Model.Basket.Lines)
                            {
                                <div>
                                    <div>
                                        <div class="container-fluid">
                                            <order-summary-item item="item">
                                                <div class="itemInfo" style="display:flex">
                                                    <div class="itemImage">
                                                        @{
                                                            var str = line.Product.Images.Where(x => x.Wear.Article == line.Product.Article).Select(x => x.ImageFile).FirstOrDefault();
                                                            var base64 = Convert.ToBase64String(str);
                                                            var imgSrc = String.Format("data:image/jpg;base64,{0}", base64);
                                                        }
                                                        <img src="@imgSrc" alt="@line.Product.Name" style="height:70px; width:70px" />
                                                    </div>
                                                    <div class="aboutItem">
                                                        <div class="itemDetails">
                                                            <div class="itemDescription">@line.Product.Name</div>
                                                            @if (line.Size != null)
                                                            {
                                                                <div class="itemSize">
                                                                    <label class="itemVariationLabel">Size:</label>
                                                                    <span style="font-size:12px">@line.Size</span>
                                                                </div>
                                                            }
                                                            <div class="itemQuantity">
                                                                <label class="itemQuantityLabel">Qty: </label>
                                                                <span style="font-size:12px">@line.Quantity</span>
                                                            </div>
                                                        </div>
                                                        <div class="itemPricing">
                                                            <div class="nowPrice">
                                                                <span class="showPriceLabel">Price:</span>
                                                                <span style="font-size:12px">@((line.Quantity * line.Product.Price).ToString("# $"))</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </order-summary-item>
                                        </div>
                                    </div>
                                </div>
                            }
                            <hr>
                        </div>
                    </div>
                </section>
                <p class="summaryTotals" style="display:flex; justify-content:space-between">
                    <span class="summaryLineLeft" style="text-transform: uppercase; font-family: Arial, Helvetica, sans-serif">Total:</span>
                    <span class="summaryLineRight" style="font-size:24px; font-weight:600">@Model.Basket.ComputeTotalValue().ToString("# $")</span>
                </p>
            </section>
        </aside>
    </div>
}

@*<script>
$(function () {
    $('body').on('click', 'button#confirmOrder', function (e) {
        e.preventDefault();
        $("#categories").hide();
    })
});
</script>*@

<script>
    $('.combobox').each(function () {
        var
            $input = $(this).find('input'),
            $select = $(this).find('select');
        function hideSelect() {
            setTimeout(function () {
                if (!$select.is(':focus') && !$input.is(':focus')) {
                    $select
                        .hide()
                        .css('z-index', 1);
                }
            }, 20);
        }
        $input
            .focusin(function () {
                if (!$select.is(':visible')) {
                    $select
                        .outerWidth($input.outerWidth())
                        .show()
                        .css('z-index', 100);
                }
            })
            .focusout(hideSelect)
            .on('input', function () {
                $select.val('');
            });
        $select
            .change(function () {
                $input.val($select.val());
            })
            .focusout(hideSelect);
    });

    $(document).ready(function () {
        $("#carousel").hide();
        $("#categories").hide();
        $("#search").hide();
        $(".checkout").hide();
        $(".menu").hide();
    });
</script>

